- error message  job operation error "" ë“¤ì–´ê°„ ê²½ìš° ë°œìƒë¨ 
    policy.prop ALLOW_ADDRESS 

- call SYS.DBMS_APPLICATION_INFO.SET_MODULE('[${JOB_NAME}]${STEP_NAME}','BATCH')}
    <property name="ignoreUnresolvablePlaceholders" value="falseëŠ”"/> falseëŠ” íŒŒë¼ë¯¸í„° ì—†ì–´ë„ ë¬´ì‹œí•¨

- _CFG ë¡œ ë³´ì´ë„ë¡ ìˆ˜ì • 
    ë°©ë²•1. BatchJobAddModelì˜ text: _.replace(name, '_CFG', '') ìˆ˜ì •
    ë°©ë²•2. 
        /anyframe-batch-agent/src/main/resources/application.properties 
        suffix=_CFG ë³€ê²½ 
       
- ë°©ì¹´ ë”°ì˜´í‘œ ë°°ì¹˜ ì—ì´ì „íŠ¸ ì •ì±… íŒŒì¼
    AgentDaoImpl 
    - êµ¬ë¶„ìëŠ” ; ì…ë‹ˆë‹¤. ex) 127.0.0.1;0.0.0.0;

- GPS í…Œì´ë¸” ì•ˆë§ë“¤ê³ , context-management.xml ì— ì„œë¹„ìŠ¤ ë¡œê·¸ ë‚¨ê¸°ëŠ” ë¹ˆ ì‚­ì œ (SLPGSPAL01 ì„œë²„ ë‚´ íŒŒì¼)
    - context-management.xml ì„¤ì •ì—ì„œ

        <bean class="com.anyframe.online.runtime.management.event.publish.ServiceEventHistoryPublisher">
                <property name="historyHandler" ref="historyHandler" />
        </bean>
    ** 2718 ë²ˆì§¸ ì¤„ 
    
ì£¼ì„ì²˜ë¦¬ í•˜ë©´ SERVICE_HISTORY í…Œì´ë¸”ì— ìƒì„± ì•ˆí•¨
- ì‚¬ë‘ì˜¨ ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸ (1ë²ˆ gpsì™€ ë™ì¼í•˜ê²Œ DBì— ë¡œê·¸  ì•ˆë‚¨ê¸°ëŠ” ë°©ë²•)


- ì˜ˆì „ ìš”ì²­ì‚¬í•­ bnk, gps ë¡œê·¸ ì‚­ì œ ë°°ì¹˜ êµ¬í˜„ ë“±ë¡


- ìš´ì˜ GA ë°°ì¹˜ ì‘ì—…ì´ë ¥ ì•ˆë³´ì´ëŠ” í˜„ìƒ
    ex) tanentid = "GPS"   / batch-job_exection = gps
    tanentid ëŠ” ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë³„í•¨ìœ¼ë¡œ batch-job_exection = GPS ë¡œ ë™ì¼í•˜ê²Œ ì„¤ì •

- Transaction timeout ì¼ì–´ë‚˜ë©´ì„œ ë¡¤ë°± ë¬¸ì œ 
    TransactionUtil.executeRequiresNew(new TransactionCallback<T>() {
    public <T> doInTransaction(TransactionStatus transactionstatus) {
            // ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§
            return result;
        }
    }, 30, "onlineTransactionManager");

- 240422 ë™ì‹œì„¤ì •ì—¬ë¶€ í—ˆìš© í›„ ë³€ê²½ ë¬¸ì˜
    **ì›ë¦¬**
        batch í”„ë¡œì íŠ¸ 
            1. DefaultJobLauncher.java  createJobExecutionì—ì„œ id, key ë¥¼ execution ìœ¼ë¡œ ë°˜í™˜ í•´ì¤€ ë’¤ stared ìƒíƒœê°€ ë¨ 
            2. ì´ë¯¸ staredë¼ì„œ countë¥¼ í•˜ì—¬ ì‹¤í–‰ì¤‘ì¸ ì„œë¹„ìŠ¤ ì œì–´ë¼í•˜ê³  ì•ˆë‚´í•¨ 
    ì¡°ì¹˜ì‚¬í•­ 
        execute ë‚´ë¶€ì—ì„œ ì²´í¬ë¥¼ í•˜ì‹œë ¤ë©´ 
        -JOB_EXECUTION_KEY(jobKey)ê°€ ì—†ì„ ê²½ìš°
                SELECT COUNT(1) FROM BATCH_JOB_EXECUTION WHERE JOB_NAME = {jobName} AND STATUS= 'STARTED' AND JOB_EXECUTION_KEY IS NULL ORDER BY JOB_ID DESC;
        -JOB_EXECUTION_KEY(jobKey)ê°€ ìˆì„ ê²½ìš°
                SELECT COUNT(1) FROM BATCH_JOB_EXECUTION WHERE JOB_NAME = {jobName} AND JOB_EXECUTION_KEY = {jobKey} AND STATUS= 'STARTED' ORDER BY JOB_ID DESC;

- ì–´ë“œë¯¼ api ì‚°ì¶œë¬¼ ì‘ì„± 
    ì„¸íŒ… 
        1. admin ì„œë²„ args  -Dencode.response-body=false ì¶”ê°€ 
        2. anyframe-enterprise-admin-web main.js 
                ì£¼ì„
                import util from '@/utils/util'; 
                const decodedContent = util.decodeBase64(response.data.content);
                const contentObj = JSON.parse(decodedContent);
                ì¶”ê°€
                const contentObj = JSON.parse(response.data.content);
        3.  npm run dev         
    postman tool ì‚¬ìš© 
    authorization ê¶Œí•œì˜ bearer token ë„£ê¸° 
    getë°©ì‹ì´ë©´ params ì¸ì ë„£ê³  send
    postë°©ì‹ì´ë©´ body raw json ë„£ê³  send 

    ì¡°íšŒ ì•ˆë˜ëŠ” ë¶€ë¶„ë“¤ì€ ì§ì ‘ URL ë§Œë“¤ì–´ì¤Œ 
    EX. http://localhost:8088/anyframe-batch-admin/batch/user/for/batch?tenantId=tenantIdA
    ì„¤ëª… : ë¸Œë¼ìš°ì €ëŠ” VUE 3000ë²ˆìœ¼ë¡œ ì—°ê²°í–ˆì§€ë§Œ ì‹¤ì œ ë°ì´í„° í™•ì¸ì€ localhost:8088/anyframe-batch-admin í•´ì•¼í•¨ 


- ë°°ì¹˜ì—ì„œ ì˜¨ë¼ì¸ í˜¸ì¶œ í†µì§€ ì œì–´ ë¬¸ì˜
    MonitorExecutorImpl
    JobExecutionMonitorServiceImpl
    JobExecutionDao
    https://devops.sdsdev.co.kr/confluence/pages/viewpage.action?pageId=1097686334



- ë°°ì¹˜ ì˜¨ë¼ì¸ìœ í˜• í†µì§€ì„¤ì • ë¬¸ì˜ #FW: RE: Anyframe admin ì—ëŸ¬ í†µì§€ ê´€ë ¨ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.
    ì˜¨ë¼ì¸ìœ í˜•ì€ ë…ë¦½ì ìœ¼ë¡œ í˜¸ì¶œë˜ëŠ” ì¡´ì¬ì´ë¯€ë¡œ 
    ì‹¤ì œ í†µë³´ëŠ” DefaultJobOperator jobMetaResolver.getMetaDataê°€ í•´ì¤Œ 
    ë¬¸ì œëŠ” ë°°ì¹˜ì˜ ì‘ì—…ëª…ì„ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì•„ë‹Œ ë°°ì¹˜ê²½ë¡œë¥¼ ê°€ì ¸ì™€ì„œ ì‘ì—…ëª…ìœ¼ë¡œ ê°€ì ¸ì˜¤ë„ë¡ ì•ˆë‚´í•¨ 
    RemoteJobLauncher launcher = new RemoteJobLauncher("localhost:15000/batch-agent");
     launcher.launch("JOB:{ë°°ì¹˜ ì‘ì—…ëª…}");


- admin ì œí’ˆì„±ìœ¼ë¡œ .warë§Œ
  sample ì»¤ìŠ¤í…€ í•„ìš”í•´ì„œ í”„ë¡œì íŠ¸ í†µìœ¼ë¡œ ë§ê¸° 
    dist/lib settings.xml ë”°ë¡œ ë§Œë“¤ì–´ì„œ dist/lib ê²½ë¡œ ì¡ì•„ì£¼ê¸°




-  
ë¬¸ì˜ì£¼ì‹  ì˜¤ë¥˜ëŠ” AFIìë°” ë²„ì „ê³¼ postgreSql í˜¸í™˜ ë¬¸ì œë¡œ ë³´ì…ë‹ˆë‹¤  
í•´ë‹¹ AFI ADMINì˜ ì„¤ì •ëœ java-version, javax.servlet-vesion ì‚¬ì–‘ í™•ì¸ì´ í•„ìš”í•˜ì—¬ ì •ë³´ ê³µìœ ë¶€íƒë“œë¦½ë‹ˆë‹¤ 

<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>servlet-api</artifactId>
			<version>2.5</version>
			<scope>provided</scope>
		</dependency>
 <dependency>
        <groupId>postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <version>9.0-801.jdbc4</version>
        </dependency>


=====cfg=====	
íŒ¨í‚¤ì§€ëŠ” í”„ë ˆì„ì›Œí¬ ê¸°ë³¸ê¸°ëŠ¥ flowì œê³µí•´ì„œ ì˜í–¥ì´ ìˆì„ ìˆ˜ìˆê² ë‹¤ ì‹¶ì–´ì„œ í™•ì¸ 
ìƒ˜í”Œ ì†ŒìŠ¤ ë‚´ì—ì„œëŠ” getJobConfigSuffix  ì‚¬ìš©í•˜ëŠ” ê³³ì€ ì—†ì–´ì„œ 
ë¡œì»¬ì—ì„œëŠ” ë¬¸ì œê°€ ë˜ì§„ ì•Šì§€ë§Œ 
ìš´ì˜í™˜ê²½ì—ì„œ ë°˜ì˜í•˜ê¸° ì „ì— í™•ì¸í•„ìš” 

ë¡œì»¬ 
ë¡œê·¸ :: 	C:\anyframe_log\admin\batchlogs\target\classes\sample\batch\hello2\cfg\hello_CFG

BatchDefine.java
JobOperatorImpl.java
if (str.endsWith('_cfg.xml')) {
        this.treeItem.selectNode = _.replace(general.location, '_cfg.xml', '');
        console.log(this.treeItem.selectNode);
      }.



const str = general.location;
      console.log(str);
      con
      console.log(general.location.endsWith('_cfg.xml'));


FileServiceImpl
        @Override
		protected void handleFile(File file, int i, Collection<FileItem> collection) {
			FileItem item = new FileItem(file, baseDir);
			
			String name = item.getName();
			for(int n=0; n < suffixes.length; n++) {
    			if(StringUtils.hasText(suffixes[n]) && name.endsWith(suffixes[n])) {
    				name = name.substring(0, name.length() - suffixes[n].length());
    				item.setName(name);
    			}
			}
			
			item.setEncoding(encoding);
			collection.add(item);
		}

=====batch 5=====
ORA-02289: ì‹œí€€ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

CREATE TABLE SAMPLE
   (	NO NUMBER NOT NULL PRIMARY KEY, 
	NAME VARCHAR2(10), 
	AGE NUMBER(6), 
	SALARY NUMBER(20), 
	BIRTHDAY DATE,
	ADDRESS VARCHAR2(100), 
	DESCRIPTION VARCHAR2(30), 
   ) ;

SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;


======240411======
ë°°ì¹˜ ì¤‘ì§€ë˜ë©´ ì‹¤ì œ ë°°ì¹˜ëŠ” ì•ˆêº¼ì§€ëŠ” ë¬¸ì œë¡œ 
ë°°ì¹˜ ì¤‘ì§€ë˜ëŠ” ë¡œì§ ë¶€í„° íŒŒì•… 

batch-agent prop ìˆ˜ì •í•˜ê¸°

ps -ef | grep /kang 

kill -9 pid


netstat -ano | findstr [í¬íŠ¸]

taskkill /FI "PID eq [PID]"


batch-sample build ì•ˆë¨ ã…‡ã……ã…‡ 

======240415======
ë°ëª¬í”„ë¡œì„¸ìŠ¤ ì£½ì´ê¸°
C:\Users\kpcnc\git\anyframe-batch-0311\anyframe-batch-sample\src\main\java\test\batch\transaction\ProcessData.java
ë°°ì¹˜ìƒ˜í”Œ ì˜¤ë¥˜ -- í•´ê²° 
ide ì˜¤ë¥˜ 
======240415======
ë°ëª¬ ë°°ì¹˜ì˜ ê²½ìš° ì‘ì—… ì´ë ¥ ì¡°íšŒ ê°€ëŠ¥ ì—¬ë¶€
ref : https://devops.sdsdev.co.kr/confluence/pages/viewpage.action?pageId=545361589
3000ë²ˆ err
linux kill err 


exception ì£¼ì„ê±¸ë¡œ test 




 Job Run Command: C:/Users/kpcnc/git/anyframe-batch-0311/anyframe-batch-sample/dist/bin/runjob.cmd JOB:CrdtDbToFile_TestServer -JOBID=4311 TENANTID
=tenantId TENANTID=tenantIdA -PROFILE=processBatch

command: JOB:240414 -JOBID=4313 TENANTID=tenantId TENANTID=tenantIdA -PROFILE=processBatch

Daemon Run Command: C:/Users/kpcnc/git/anyframe-batch-0311/anyframe-batch-sample/dist/bin/rundaemon.cmd -ID=240412 -SERVER=TestServer -PROFILE=
processBatch -TENANTID=tenantIdA


ë°°ì¹˜ 
Job Run Command: C:/Users/kpcnc/git/anyframe-batch-0311/anyframe-batch-sample/dist/bin/runjob.cmd JOB:240414 -JOBID=4631 TENANTID=tenantId TENANTI
D=tenantIdA -PROFILE=processBatch

ë°ëª¬
aemonExecutionManagerImpl : Daemon Run Command: C:/Users/kpcnc/git/anyframe-batch-0311/anyframe-batch-sample/dist/bin/rundaemon.cmd -ID=240411 -SERVER=TestServer -PROFILE=
processBatch -TENANTID=tenantIdA
[2024-04-17 13:46:23] DEBUG processL

ë™ì‹œì„± x
ì˜ˆë¡œ 1ë¶„ ì–´ë“œë¯¼ë°°ì¹˜ ì„¸íŒ… 1ë¶„30ì´ˆ ë°°ì¹˜ ì‹¤í–‰ 
started ìƒíƒœì—ì„œ fail

ë™ì‹œì„±o 
1ë¶„ ì–´ë“œë¯¼ë°°ì¹˜ ì„¸íŒ…  1ë¶„30ì´ˆ ë°°ì¹˜ ì‹¤í–‰ 
started ìƒíƒœì—ì„œ ë°°ì¹˜ ì¢…ë£Œë˜ëŠ” ë°©í–¥ 

===================0422

util import ì œê±° 
ì†ì±…ì„ë‹˜ ì—‘ì…€ ã…‡base64 ì£¼ì„

===================0429
ì„¼í„°ì»· api 
ë¦¬ëˆ…ìŠ¤ ë¶€íŠ¸ ë‹¤ì‹œ íŒŒì„œ í•´ë³´ê¸° 

===================0503
ì„¼í„°ì»·ë¡œì»¬ì„¸íŒ…
ì„¼í„°ì»·apiì‘ì„±



/home/kpcnc/output/edu/shell]$ find ./ -type f -not -name "*.log"



diff -u a.txt b.txt

/home/kpcnc/output/sample/etc_ori /home/kpcnc/output/sample/etc 

sed -e 's/\/etc/\/etc_ori/g' -e s/^M//g`

find: paths must precede expression: *.class
Usage: find [-H] [-L] [-P] [-Olevel] [-D help|tree|search|stat|rates|opt|exec] [path..            .] [expression]

https://github.com/deathmarine/Luyten/releases


https://contradicto-lee.tistory.com/45
i
sed -e 's/\/home/kpcnc/output/sample/etc_ori/\/home/kpcnc/output/sample/etc/g' -e s/^M//g`

https://non-stop.tistory.com/101

diff -r /home/kpcnc/output/sample/etc_ori /home/kpcnc/output/sample/etc | sed '/Binary\ files\ /d' >outputfile


diff -rq /home/kpcnc/output/sample/etc_ori /home/kpcnc/output/sample/etc | grep -E "^Only in /dir1*" | sed -n 's/://p' | awk '{print $3"/"$4}' xargs -I {} rm -r {}

diff -rq /home/kpcnc/output/sample/local /home/kpcnc/output/sample/real | grep -E "^Only in /home/kpcnc/output/sample/etc_ori*" | sed -n 's/://p' | awk '{print $3"/"$4}'


diff -r /home/kpcnc/output/sample/realSample /home/kpcnc/output/sample/localSample

diff -rq /home/kpcnc/output/sample/realSample /home/kpcnc/output/sample/etc_ori | grep -E "^Only in /home/kpcnc/output/sample/etc*"

1. í•˜ìœ„ë””ë ‰í† ë¦¬ ë¹„êµ 
2. ë¡œì»¬ë³€ê²½ì‹œ , ìš´ì˜ë³€ê²½ ì‹œ 



colordiff -ur /home/kpcnc/output/sample/local /home/kpcnc/output/sample/real

===================0717
[Anyframe Admin]ì—…ë¬´ ID ì •ë ¬ ê´€ë ¨ ë¬¸ì˜

/anyframe-enterprise-admin-common/src/main/resources/mappings/tenantadmin-queries.xml
ì¿¼ë¦¬ id tenantAdminDAO.selectTenantList, tenantAdminDAO.selectTenantListByUserId

===================0716
Anyframe ë°°ì¹˜ ë¡œê·¸(log) ê´€ë ¨ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.

ANYFRAME.INTERFACE_SYSTEM_LOGí…Œì´ë¸”ì„ ì¡°íšŒí–ˆì„ë•Œ ì•„ë˜ ìº¡ì³ì™€ ê°™ì´ PGM_IDí•­ëª©ì´ ê³µë°±ìœ¼ë¡œ í‘œì‹œë˜ì–´ ìˆëŠ”ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
ë™ì¼í•œ STTD_UUIDê¸°ì¤€ìœ¼ë¡œ ë³´ë©´ í•´ë‹¹ ì˜ì—­ì˜ PGM_IDê°’ì´ ìµœì¢…ì²˜ë¦¬ ê²°ê³¼ì—ë§Œ ë¹„ì–´ìˆëŠ”ê²ƒìœ¼ë¡œ ë³´ì—¬ì„œ 
í•´ë‹¹ í•­ëª©ì— ê°’ì„ ë“±ë¡í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•˜ëŠ” ë°©ë²• ê°€ì´ë“œ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

===================0722
ë°°ì¹˜ì„œë²„ì˜ ë””ìŠ¤í¬ ì¦ê°€ë¡œ ë¡œê·¸ íŒŒì¼ ì •ë¦¬ ì‘ì—… í›„ì—ë„ ë””ìŠ¤í¬ ì‚¬ì´ì¦ˆê°€ ì¤„ì§€ ì•Šì•„ í™•ì¸ê²°ê³¼
ì•„ë˜ /home/mes30bat/batch/agent/tomcat/logs í•˜ìœ„ catalina.out íŒŒì¼ ì‚¬ì´ì¦ˆê°€ 29G ê¹Œì§€ ì¦ê°€í•œ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.

1. í•´ë‹¹ íŒŒì¼ì— logë¥¼ ìŒ“ì§€ì•ŠëŠ” ë°©ë²• 
>> /dev/null 2>&1 &

2. ì„ì‹œì¡°ì¹˜ë¥¼ ìœ„í•´ ë°°ì¹˜ì„œë²„ ì¬ê¸°ë™ ì—†ì´ í•´ë‹¹ íŒŒì¼ ì‚­ì œì²˜ë¦¬í•˜ëŠ” ë°©ë²•
# cat /dev/null > catalina.out

===================0724
INTERFACE_SYSTEM_LOG í…Œì´ë¸” PGM_ID ì•ˆìŒ“ì´ëŠ” ë¬¸ì œ
-> PGM_IDê°€ ì•ˆìŒ“ì´ëŠ” ì´ìœ ê°€ ì¸í„°í˜ì´ìŠ¤(EAI OR FEP)ì—ì„œ ë¦¬í„´ë°›ëŠ” ê°’ì— PGM_IDê°€ ì—†ì–´ì„œ ì—…ë°ì´íŠ¸ ë¡œì§ì„ ì¶”ê°€

->  HttpMessageSender.send  jobNameì„ ì¶”ê°€ í›„ ë¦¬í„´ê°’ìœ¼ë¡œ ì¸í’‹ê°’ì„ ë°”ë¡œ ë°›ì•„ë„ ë˜ëŠ”ì§€ ì¶”ê°€ ë¬¸ì˜
===================0812 í•œêµ­ì‚°ì—…ì€í–‰
ë¬¸ì˜ : 
        agent batch server ì‹¤í–‰ ì˜¤ë¥˜ 
        WARN  [08/12 08:39:21] Connection factory returned null from createConnection - uli83t-7085
        java.lang.IllegalStateException: Connection factory returned null from createConnection

ì›ì¸ : 
        [ps -ef | grep agent ê²°ê³¼ë¬¼]
        anyframe 13726     1  0  8â–’â–’  3  ?        1387:16 /opt/java6/bin/IA64N/java -Djava.util.logging.config.file=/usropt83/anyframe/batch/agent/tomcat-agent-p/conf/logging.properties
        anyframe 13736     1  0  8â–’â–’  3  ?        2185:03 /opt/java6/bin/IA64N/java -Djava.util.logging.config.file=/usropt83/anyframe/batch/agent/tomcat-agentn-s/conf/logging.properties
            jeus 26601     1  0  4â–’â–’  6  ?        408:18 /opt/java6/bin/IA64N/java -Dname=mwagent.jeus -Xms128m -Xmx128m -jar /usropt83/jeus/MWAgent/mwmanager4j6.jar
        anyframe  3709  3422  0 11:10:42 pts/1     0:00 grep agent
        anyframe 19590     1  0  8â–’â–’ 12  ?         3:09 /opt/java6/bin/IA64N/java -Djava.util.logging.config.file=/usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-p/conf/logging.pro
        anyframe 19632     1  0  8â–’â–’ 12  ?         3:06 /opt/java6/bin/IA64N/java -Djava.util.logging.config.file=/usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-s/conf/logging.pro

        /usropt83/anyframe/batch/agent/tomcat-agent-P
        /usropt83/anyframe/batch/agent/tomcat-agent-s
        /usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-p
        /usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-s

        ì´ 4ê°œ agent ë„ì–´ì ¸ ìˆìŒ 

        [ ì°¨ì„¸ëŒ€ ì´ì „ì— ì‚¬ìš©í–ˆë˜ í”„ë¡œì„¸ìŠ¤ë¡œ í˜„ì¬ ì‚¬ìš©  x]
        /usropt83/anyframe/batch/agent/tomcat-agent-p
        /usropt83/anyframe/batch/agent/tomcat-agent-s

        [í˜„ì¬ ì‚¬ìš© o]
        /usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-p 
        /usropt83/NGS/anyframe_cs/batch/agent/tomcat-agent-s

ì¡°ì¹˜ :    
        ì°¨ì„¸ëŒ€ agent tomcat ì„œë²„ kill í•˜ì—¬ ì¡°ì¹˜ 
        jgroup agent 2ê°œë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì–´ í´ëŸ¬ìŠ¤í„°ë§ ëª©ì 
        agent-primary, agent-secondaryë¡œ êµ¬ë¶„í•˜ì—¬ ì£¼ agent(primary)ê°€ ë™ì‘ì„ ë©ˆì¶”ê±°ë‚˜ ì˜¤ë¥˜ê°€ ë‚˜ë©´ ë‹¤ë¥¸ ì—ì´ì „íŠ¸(secondary)ê°€ ëŒ€ì‹  ìˆ˜í–‰í•¨.


execute cfg java íŒŒì¼ 
context-batch-runtime.xml


    -> batch.properties 
        batch.database.persist=true


ì•ˆë…•í•˜ì„¸ìš” Anyframe ê¸°ìˆ ì§€ì› ê¹€ì˜ˆì€ì…ë‹ˆë‹¤. 

ë³´ë‚´ì£¼ì‹   jdbc ì—°ê³„ ì¤‘ Step execution error ì˜¤ë¥˜ì¡°ì¹˜ë¥¼ ìœ„í•´ì„œ anyframe ì„¤ì • ë° ì†ŒìŠ¤ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. 

- step id GateRcvDBIntegrationTaskì˜ java íŒŒì¼ 
- context-batch-runtime.xml
- context-batch-transaction.xml



===================240829
Anyframe Onlineì—ì„œ ì œê³µë°›ì•˜ë˜ "xercesImpl-2.12.0.jar"ì— ëŒ€í•´ "CVE-2020-14338" ì·¨ì•½ì ì´ ì¡´ì¬í•¨ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.
ì•ˆì „ë²„ì „ì€ 2.12.2 ë²„ì „ì´ í™•ì¸ë˜ë©°, í•´ë‹¹ libì™€ ì—°ê´€ë˜ëŠ” libë“¤ì´ ìˆë‹¤ë©´, ê°™ì´ ì œê³µë¶€íƒë“œë¦½ë‹ˆë‹¤.
ë³´ì•ˆì·¨ì•½ì  ìƒì„¸ë‚´ìš©ì€ ì²¨ë¶€íŒŒì¼ ì°¸ê³ ë°”ëë‹ˆë‹¤.
ì¡°ì¹˜ : anyframe-online-runtime-ext xercesImpl-2.12.0 - > 2.12.2 ë²„ì „ì—…

2024.10.31 ë³´ì•ˆì·¨ì•½ì  ë³€ê²½ (xercesImpl-2.12.0 > 2.12.2)

xí”„ë¼ì„ ext ì†ŒìŠ¤ ì»¤ìŠ¤í…€ ì—¬ë¶€ í™•ì¸ í›„ ì œê³µ


maven goals 
    .jar ì¶”ì¶œ ì‹œ , install :: local repository upload
    nexus ë°°í¬ ì‹œ, deploy ::  nexus upload 

anyframe í˜•ìƒê´€ë¦¬ ê¹ƒì´ë‘ ë„¥ì„œìŠ¤ ë‘ ê°œ ë‹¤ í•´ì•¼í•¨ !
    ê¹ƒ ì†ŒìŠ¤ pom.xml ì†ŒìŠ¤ íŒ¨ì¹˜ 
    ë„¥ì„œìŠ¤ ë°”ì´ë„ˆë¦¬ source.jar ì†ŒìŠ¤ íŒ¨ì¹˜  

ì·¨ì•½ì ê´€ë ¨ ì‚¬ì´íŠ¸  : mvn repository

<nexus ë°°í¬ >
    1. pom.xml 
    <pluginRepositories>
            <pluginRepository>
                <id>TeamStafInternalRepository</id>
                <url>http://70.121.224.52:8081/nexus/content/repositories/public/</url>
            </pluginRepository>
        </pluginRepositories>
        
        <distributionManagement>
            <repository>
                <id>anyframe-repository</id>
                <url>http://70.121.224.52:8081/nexus/content/repositories/anyframe-releases</url>
            </repository>
            <snapshotRepository>
                <id>anyframe-snapshot-repository</id>
                <url>http://70.121.224.52:8081/nexus/content/repositories/anyframe-snapshots</url>
            </snapshotRepository>
        </distributionManagement>



    2. settings.xml
    <servers>
            <server> 
                <id>anyframe-repository</id> <username>deployment</username> <password>deployment0</password> 
            </server> 
            <server> 
                <id>anyframe-snapshot-repository</id> <username>deployment</username> <password>deployment0</password> 
            </server> 

            <!-- Another sample, using keys to authenticate. <server> <id>siteServer</id> 
                <privateKey>/path/to/private/key</privateKey> <passphrase>optional; leave 
                empty if not used.</passphrase> </server> -->
        </servers>


    3. clean deploy -Dpmd.skip=true
        
    [INFO] Uploading: http://70.121.224.52:8081/nexus/content/repositories/anyframe-snapshots/com/anyframe/anyframe-online-runtime-ext/6.5.0-SNAPSHOT/maven-metadata.xml
    [INFO] Uploaded: http://70.121.224.52:8081/nexus/content/repositories/anyframe-snapshots/com/anyframe/anyframe-online-runtime-ext/6.5.0-SNAPSHOT/maven-metadata.xml (1003 B at 54.4 
    KB/sec)

    uploaded ë˜ë©´ ë ê²½ë¡œê°€ì„œ í™•ì¸í•´ë³´ê¸° 


<git ë°°í¬> 
    pom.xml íŒ¨ì¹˜í•´ì•¼í•´ì„œ commit 

==================================240829
left ë©”ë‰´ ì•ˆë‚˜ì˜¤ëŠ” ì´ìŠˆ 
-> history í…Œì´ë¸”ì—  200x ë…„ ë°ì´í„°ê¹Œì§€ ë‚¨ì•„ìˆì–´ì„œ ë¡œë”© ì‹œ ì˜¤ë˜ ê±¸ë¦¼ 
db ì‚­ì œ í›„ ì²˜ë¦¬ 
==================================240830
ë¬¸ì˜ : ì„¼í„°ì»· commit responseë˜ëŠ” ë¶€ë¶„ í™•ì¸ 

1. 
final int transactionStatus = synchronization.getStatus(); -> 1 ì™„ë£Œê°’

2.
mainprocesshandler.java
chunkRepository.saveStatus(chunk); // MAIN_PROCESS_START-> MAIN_PROCESS_COMPLETE

3.
chunkserviceImpl
96 postProcessHandler.handle(chunk, chunkItems); //COMPLET -> POST_PROCESS_COMPLETE

4.
104 ChunkStatus status = chunkStatusChecker.getChunkStatus(chunk);  COMPLETE -> COMPLETE_ALL [afcc_chunk]
chunkDao 36 updatestatus update í•¨

5.
jobexecutionmanagerimpl 
147 return jobinstance.getInstancestatus()

6.
finishJobInstance
complete all 
TransactionAspectSupport	transactioninterceptor() ->COMPLETE ALL [afcc_job_instance ]
 

ìˆ˜ì„ë‹˜ ì˜¤ì „ì— ë§ì”€í•˜ì‹  COMPLETE response ë°›ëŠ” ë¶€ë¶„ ê³µìœ ë“œë¦½ë‹ˆë‹¤.

1. anyframe-centercut-runtime í”„ë¡œì íŠ¸ì˜ chunkserviceImpl.java 104 ë¼ì¸ì—ì„œ COMPLETE ê°’ ì¶”ì¶œ
2. 106ë¼ì¸ì—ì„œ AFCC_CHUNKí…Œì´ë¸”ì˜ COMPLETE_ALL í•˜ì—¬ UPDATE 
3. anyframe-centercut-engine í”„ë¡œì íŠ¸ì˜ 208ë¼ì¸ finishjobInstanceë©”ì†Œë“œ íƒ€ë©´ì„œ 
4. TransactionAspectSupportì•ˆì— transactioninterceptor() í•¨ìˆ˜ì—ì„œ AFCC_JOB_INSTANCE í…Œì´ë¸”ì— COMPLETE ALL í•´ì¤ë‹ˆë‹¤

centercut


runJobAsync 
com\anyframe\centercut\interfaces\invocation\CenterCutInvocationUtil.java

perpareJob


ì¸ìŠ¤í„´ìŠ¤ : ë³‘ë ¬ì²˜ë¦¬ì˜ ë‹¨ìœ„ê°€ ë˜ëŠ” ë‹¨ìœ„ì‘ì—… ë¦¬ìŠ¤íŠ¸ 
ë‹¨ìœ„ì‘ì—… : ë³‘ë ¬ì²˜ë¦¬ ìˆ˜í–‰ë‹¨ìœ„
ë‹¨ìœ„ì‘ì—…(Chunk)ì´ë€ ë³‘ë ¬ì²˜ë¦¬ì˜ ìˆ˜í–‰ë‹¨ìœ„ê°€ ë©ë‹ˆë‹¤. ì„¼í„°ì»· ì—”ì§„(Engine)ì—ì„œëŠ” í•­ìƒ ë‹¨ìœ„ì‘ì—… ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ
ìš”ì²­ì„ ì„¼í„°ì»· ì‹¤í–‰í™˜ê²½(Runtime)ìœ¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤

jobì‹¤í–‰ ë””ë²„ê¹… 
1. runtime 
	com.anyframe.centercut.runtime.service.ChunkServiceImpl - execute
	ì„ ì²˜ë¦¬ : preProcessHandler.handle(chunk, chunkItems);
	ë³¸ì²˜ë¦¬ : mainProcessHandler.handle(chunk, chunkItems);
	í›„ì²˜ë¦¬ : postProcessHandler.handle(chunk, chunkItems);
	
	chunkRepository.saveStatus(chunk); : ChunkStatus : COMPLETE


2. engine
	com.anyframe.centercut.engine.execution.manager.JobExecutionManagerImpl - finishJobInstance âœ… instance ë³€ê²½ !
	com.anyframe.centercut.engine.execution.event.JobFinishEvent - handle
	JobExecutionEventListener - onApplicationEvent
	com.anyframe.centercut.engine.core.event.handler.JobExecutionEventHanlderImpl - handleEvent



3. runtime 
	com.anyframe.centercut.runtime.service.ChunkServiceImpl - execute ( return chunk.getChunkStatus().isSucceed(); )
	com.anyframe.centercut.runtime.agent.CenterCutAgentImpl - executeChunk




4. spring	
	org.springframework.transaction.support.TransactionTemplate - T execute(TransactionCallback<T> action)
	java.util.concurrent.ThreadPoolExecutor - runWorker(Worker w)


--------------------------------------0902 ìµœìˆ˜ì„ë‹˜ ë³€ê²½ì‚¬í•­ 
CenterCutAgentImpl.java ì†ŒìŠ¤ì˜ 
  public boolean executeChunk(Chunk chunk) í•´ë‹¹ ë©”ì†Œë“œ ë¶€ë¶„ ìˆ˜ì •

          ë³€ê²½ì „
          CenterCutAgentImpl.this.chunkService.execute(this.val$chunk);
          ë³€ê²½í›„
          if (!CenterCutAgentImpl.this.chunkService.execute(this.val$chunk)
          {
            CenterCutAgentImpl.logger.error("Chunk execution failed. : ", throwable);
            this.val$chunk.setExitMessage(ExceptionUtils.getStackTrace(throwable));
            this.val$chunk.setChunkStatus(ChunkStatus.FAIL);
            CenterCutAgentImpl.this.chunkRepository.saveExitMessage(this.val$chunk);
          {


MainProcessHandler.java ì†ŒìŠ¤ì˜
  public ChunkAction handle(Chunk chunk, ChunkItems chunkItems) í•´ë‹¹ ë©”ì†Œë“œ ë¶€ë¶„ ìˆ˜ì •
  
      ë³€ê²½ì „
      this.sameErrorInfoChecker.setMaxErrorCount(chunk.getJobConfig().getJobExecutionPolicy().getMaxErrorRepeatCount());
      ë³€ê²½í›„
      this.sameErrorInfoChecker.setMaxErrorCount(chunk.getJobConfig().getJobExecutionPolicy().getMaxErrorRate());

      í•´ë‹¹ ë¶€ë¶„ì€ 3ê³³ì´ ìˆìŒ
      ë³€ê²½ì „
            if ((!item.getItemStatus().isSystemError()) || (!item.isProcessable()) || (action != null)) break;
            doInterval(interval, item.getRetryCount(), autoRetryCount);
      ë³€ê²½í›„
  	        if (item.getItemStatus().isSystemError() && item.isProcessable() && action == null) {							
							doInterval(interval, item.getRetryCount(), autoRetryCount);							
							continue;
						} else {
							break;
						}

ë³€ê²½ì‚¬í•­ì„ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.
í™•ì¸í•˜ì‹œê³  ìˆ˜ì • í…ŒìŠ¤íŠ¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

â­ğŸŒâ­ğŸŒ
1. anyframe-centercut-engine-5.0.2 JobInstanceDao ë°˜ì˜ 
2. online runtime ext  ì·¨ì•½ì  ë²„ì „ì—… ë°˜ì˜ ==
========================================


SELECT * fROM AFCC_ERROR_INFO 
WHERE JOB_ID IN ('sample1')
and exec_date = 20240904
;
SELECT * fROM AFCC_EXEC_EVENT 
WHERE JOB_ID IN ('sample1')
and exec_date = 20240904
;
SELECT * fROM AFCC_JOB_CONFIG
WHERE JOB_ID IN ('sample2', 'sample1')
--and exec_date = 20240904
;
select * from afcc_application_jobs;
select *  
fROM AFCC_JOB_INSTANCE 
WHERE JOB_ID IN ('sample2', 'sample1')
and exec_date = 20240904
;
select *  fROM AFCC_CHUNK
WHERE JOB_ID IN ('sample2', 'sample1')
and exec_date = 20240904
;

//0919
delete fROM AFCC_JOB_INSTANCE WHERE JOB_ID IN ('sample2');
delete  fROM AFCC_CHUNK WHERE JOB_ID IN ('sample2');

commit;


SELECT /*+ LEADING(CHUNK, INSTANCE) USE_NL(CHUNK INSTANCE)  */ 
    CHUNK.JOB_ID, CHUNK.EXEC_DATE, CHUNK.EXEC_SEQ, CHUNK_SEQ, START_INDEX, 
    END_INDEX, THREAD_GROUP, CHUNK_STATUS, AGENT.AGENT_ID, MONITOR_CHECK, 
    CHUNK.PRE_START_TIME, CHUNK.PRE_END_TIME, CHUNK.MAIN_START_TIME, CHUNK.MAIN_END_TIME, 
    CHUNK.POST_START_TIME, CHUNK.POST_END_TIME, CHUNK.INPUT_COUNT, CHUNK.INPUT_TOTAL, 
    CHUNK.SUCCESS_COUNT, CHUNK.SUCCESS_TOTAL, CHUNK.FAIL_COUNT, CHUNK.FAIL_TOTAL, 
    CHUNK.BIZ_FAIL_COUNT, CHUNK.BIZ_FAIL_TOTAL, INSTANCE.DOMAIN_ID, HEAD_SERVICE_ID, 
    BODY_SERVICE_ID, TAIL_SERVICE_ID, TARGET_INPUT_TABLE, JOB_PRE_PROCESSOR, 
    JOB_POST_PROCESSOR, CHUNK_PRE_PROCESSOR, CHUNK_POST_PROCESSOR, HEAD_INTERCEPTOR, 
    BODY_INTERCEPTOR, TAIL_INTERCEPTOR, ITEM_READER, EXECUTION_POLICY, PARTITION_POLICY, 
    CHUNK_SIZE, INSTANCE.MAX_THREAD_COUNT, MAX_ERROR_RATE, MAX_ERROR_REPEAT_COUNT, AUTO_RETRY_COUNT, 
    PROCESSING_INTERVAL, TIMEOUT, LOGGING, SIMULATION, LOG_LEVEL, SYSTEM_ERROR_RETRY 
    FROM AFCC_AGENT_CONFIG AGENT, 
    AFCC_CHUNK CHUNK, 
    AFCC_JOB_INSTANCE INSTANCE 
 WHERE RTRIM(CHUNK.JOB_ID) = INSTANCE.JOB_ID 
 AND RTRIM(CHUNK.EXEC_DATE) = INSTANCE.EXEC_DATE 
 AND CHUNK.EXEC_SEQ = INSTANCE.EXEC_SEQ 
 AND CHUNK_STATUS IN (?, ?, ?, ?, ?, ?, ?, ?) 
 AND AGENT.AGENT_ID = CHUNK.AGENT_ID AND MONITOR_CHECK = ? 
 AND CHUNK_SEQ NOT IN (0,2147483647)]
CenterCutAgentImpl.java  113 -> mainProcessHandle.java 103 handle -> Itemprocesshandle.java 149 ->  Itemprocesshandle.java return 281 -> Itemprocesshandle.java finally 151 -> Itemprocesshandle.java catch ë¬¸ 194
-> mainProcessHandle.java 152 MAIN_PROCESS_start -> MAIN_PROCESS_COMPLETE

--00 ready 
--33 complete all 
-- 34



--1
select * From
(
select a.JOB_ID, a.EXEC_DATE, b.JOB_NAME
from afcc_job_instance a left outer join afcc_job_config b
on a.job_id = b.job_id
)
where exec_date = 20240904
;
--2
select * from AFCC_JOB_INSTANCE_PARAMS;
--3
select * From
(
select a.JOB_ID, a.EXEC_DATE
from AFCC_CHUNK a left outer join AFCC_JOB_INSTANCE b
on a.job_id = b.job_id
AND a.EXEC_DATE = b.EXEC_DATE AND a.EXEC_SEQ = b.EXEC_SEQ
)
where exec_date = 20240904
;


024-09-02 17:11:47] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [33]
[2024-09-02 17:11:48] ERROR MainProcessHandler : Chunk main process could not be executed.[jobId=sample2, execDate=20240902, execSeq=1, chunkSeq=1]
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'preProcess' available
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:816) ~[spring-beans-5.2.21.RELEASE.jar:5.2.21.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1288) ~[spring-beans-5.2.21.RELEASE.jar:5.2.21.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:298) ~[spring-beans-5.2.21.RELEASE.jar:5.2.21.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-5.2.21.RELEASE.jar:5.2.21.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1109) ~[spring-context-5.2.21.RELEASE.jar:5.2.21.RELEASE]
	at com.anyframe.centercut.runtime.factory.BeanProcessorFactory.createInstance(BeanProcessorFactory.java:23) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.service.handler.ItemProcessHandler.handle(ItemProcessHandler.java:206) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.service.handler.MainProcessHandler.handle(MainProcessHandler.java:103) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.service.ChunkServiceImpl.execute(ChunkServiceImpl.java:94) [anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.agent.CenterCutAgentImpl$1.run(CenterCutAgentImpl.java:113) [anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_202]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_202]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_202]
[2024-09-02 17:11:50] DEBUG ServiceContextClearInterceptor : â–  ThreadLocal(MDC, ServiceContext) cleared. Current Thread ID [100000]
[2024-09-02 17:11:50] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear SGC. Current Thread ID of SGC [32]
[2024-09-02 17:11:50] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [32]

`nono

---------------------------------------------------------------------------------------------------------------

[2024-09-02 17:25:35] DEBUG ServiceContextClearInterceptor : â–  ThreadLocal(MDC, ServiceContext) cleared. Current Thread ID [100001]
[2024-09-02 17:25:35] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear SGC. Current Thread ID of SGC [33]
[2024-09-02 17:25:35] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [33]
[2024-09-02 17:25:36] ERROR ChunkServiceImpl : Chunk execution failed.
com.anyframe.centercut.runtime.exception.ChunkMainProcessException: Chunk main process could not be executed.[jobId=sample2, execDate=20240902, execSeq=1, chunkSeq=1]
	at com.anyframe.centercut.runtime.service.handler.MainProcessHandler.handle(MainProcessHandler.java:169) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.service.ChunkServiceImpl.execute(ChunkServiceImpl.java:94) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.agent.CenterCutAgentImpl$1.run(CenterCutAgentImpl.java:113) [anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_202]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_202]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_202]dd
Caused by: java.lang.ClassCastException: com.anyframe.centercut.runtime.service.ChunkServiceImpl cannot be cast to com.anyframe.centercut.runtime.service.interceptor.OnlineServiceI
nterceptor
	at com.anyframe.centercut.runtime.service.handler.ItemProcessHandler.handle(ItemProcessHandler.java:206) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	at com.anyframe.centercut.runtime.service.handler.MainProcessHandler.handle(MainProcessHandler.java:103) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
	... 5 common frames omitted
[2024-09-02 17:25:38] DEBUG ServiceContextClearInterceptor : â–  ThreadLocal(MDC, ServiceContext) cleared. Current Thread ID [100000]
[2024-09-02 17:25:38] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear SGC. Current Thread ID of SGC [32]
[2024-09-02 17:25:38] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [32]
[2024-09-02 17:25:41] DEBUG ServiceContextClearInterceptor : â–  ThreadLocal(MDC, ServiceContext) cleared. Current Thread ID [11010]
[2024-09-02 17:25:41] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear SGC. Current Thread ID of SGC [26]
[2024-09-02 17:25:41] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [26]
[2024-09-02 17:25:45] DEBUG ServiceContextClearInterceptor : â–  ThreadLocal(MDC, ServiceContext) cleared. Current Thread ID [11111]
[2024-09-02 17:25:45] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear SGC. Current Thread ID of SGC [31]
[2024-09-02 17:25:45] DEBUG ServiceContextHolder : [FRAMEWORK_OLT]__________ â–  Clear all SLC. Current Thread ID of SGC [31]
[2024-09-02 17:25:48] DEBUG ServiceContextClea
================================================0909
ìµœìˆ˜ì„ë‹˜ ìš”ì²­ ê±´  : í™”ì¬ì†ŒìŠ¤ ë¹„êµ í›„ í¬íŒ…

interfaces
runtime
engine

input table 
jobinstance 
chunk

/home/kpcnc/output/sample/tar/interface/local
/home/kpcnc/output/sample/tar/interface/real

/home/kpcnc/output/sample/tar/engine/local
/home/kpcnc/output/sample/tar/engine/real

/home/kpcnc/output/sample/tar/runtime/local
/home/kpcnc/output/sample/tar/runtime/real


C:\Users\kpcnc\git\anyframe-centercut-v5.0.0\anyframe-centercut-runtime\src\main\java\com\anyframe\centercut\runtime\service\handler\OnlineResultHolder.java_

<<ë³€ê²½ì‚¬í•­>>
centerCutAgentImpl.java ì†ŒìŠ¤ì˜ 
  public boolean executeChunk(Chunk chunk) í•´ë‹¹ ë©”ì†Œë“œ ë¶€ë¶„ ìˆ˜ì •

          ë³€ê²½ì „
          CenterCutAgentImpl.this.chunkService.execute(this.val$chunk);
          ë³€ê²½í›„
          if (!CenterCutAgentImpl.this.chunkService.execute(this.val$chunk)
          {
            CenterCutAgentImpl.logger.error("Chunk execution failed. : ", throwable);
            this.val$chunk.setExitMessage(ExceptionUtils.getStackTrace(throwable));
            this.val$chunk.setChunkStatus(ChunkStatus.FAIL);
            CenterCutAgentImpl.this.chunkRepository.saveExitMessage(this.val$chunk);
          {


MainProcessHandler.java ì†ŒìŠ¤ì˜
  public ChunkAction handle(Chunk chunk, ChunkItems chunkItems) í•´ë‹¹ ë©”ì†Œë“œ ë¶€ë¶„ ìˆ˜ì •
  
      ë³€ê²½ì „
      this.sameErrorInfoChecker.setMaxErrorCount(chunk.getJobConfig().getJobExecutionPolicy().getMaxErrorRepeatCount());
      ë³€ê²½í›„
      this.sameErrorInfoChecker.setMaxErrorCount(chunk.getJobConfig().getJobExecutionPolicy().getMaxErrorRate());



ì—ì´ì „íŠ¸ ì‹¤í–‰ í›„ ì²« ë¡œì§ ? executeChunk

rror creating bean with name 'urlMapping' defined in file [C:\kye\eclipse\workspace\centercut_v5.0.0\.metadata\.plugins\or
g.eclipse.wst.server.core\tmp0\wtpwebapps\anyframe-online-aui-mybatis-pi\WEB-INF\classes\spring\context-base.xml]: Initialization of bean failed; nested exception is org.springfram
ework.beans.factory.BeanCreationException: Error creating bean with name '/centerCutAgent'


ë¬¸ì œ : 
<dependency>
            <groupId>org.springframework.integration</groupId>
            <artifactId>spring-integration-core</artifactId>
            <!-- <version>3.0.1.RELEASE</version> -->
            <version>${spring.integration.version}</version>
<!--             <version>1.0.3.RELEASE</version> -->
        </dependency>

ë‚®ì€ ë²„ì „ì€ <spring.integration.version>5.3.10.RELEASE</spring.integration.version> ì•ˆì“°ê³  ë” ë‚®ì€ê±° ì”€

spring message ë¡œ í†µì‹  í•˜ëŠ”ë° 

1. ì˜¤ë¥˜ : 
Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile (default-compile) on project anyframe-online-aui-mybatis-pi: Compilation failure
[ERROR] C:\Users\kpcnc\git\anyframe-centercut-v5.0.0\anyframe-online-aui-mybatis-pi\src\main\java\com\anyframe\centercut\runtime\executor\SampleOnlineServiceExecutor.java:[77,19] e
rror: cannot access Message
[ERROR] -> [Help 1]
[ERROR] 

2.
í™”ì¬ëŠ” ë‚®ì€ ë²„ì „ message (package org.springframework.integration.core;) => spring-integration-core-1.0.3.release.jar
í˜„ì¬ ì†ŒìŠ¤ëŠ” 6ë²„ì „ message (package org.springframework.messaging;) => spring-messaging-5.2.19.release.jar

ìƒì´í•´ì„œ ì„œë²„ ì˜¤ë¥˜ ë‚˜ì˜¤ëŠ” ê±°ì„ 

3.
ë‚®ì€ê±° ì°¾ìŒ
http://182.195.89.102/subv/temp/anyframe-online-aui-mybatis-pi/anyframe-online-aui-mybatis-pi



com.anyframe.online.runtime.integration.channel.interceptor.GlobalIdSettingInterceptor

<ë³€ê²½ì „>
import org.springframework.integration.Message;
import org.springframework.integration.MessageChannel;

<ë³€ê²½ì „>
import org.springframework.integration.core.Message;
import org.springframework.integration.core.MessageChannel;

anyframe-online-aui-mybatis-pi\src\main\resources\management.properties
eventlog.partition.value=D
servicelog.partition.value=D


<!-- <?xml version="1.0" encoding="UTF-8"?> -->
<!-- <beans xmlns="http://www.springframework.org/schema/beans" -->
<!--        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" -->
<!--        xmlns:context="http://www.springframework.org/schema/context" -->
<!--        xmlns:int-jmx="http://www.springframework.org/schema/integration/jmx" -->
<!--        xmlns:jee="http://www.springframework.org/schema/jee" -->
<!--        xmlns:task="http://www.springframework.org/schema/task" -->
<!--        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd -->
<!--  		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd -->
<!--  		http://www.springframework.org/schema/integration/jmx http://www.springframework.org/schema/integration/jmx/spring-integration-jmx.xsd  -->
<!-- 		http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd  -->
<!--  		http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd">  -->


ì†ì„±ê³µë¶€ 
xmlns:xsi  :: xml schema instance , xml ë¬¸ì„œê°€ ìŠ¤í‚¤ë§ˆë¥¼ ë”°ë¥´ë„ë¡ ì„¤ì • 
xmlns:tx   :: spring íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ 
xmlns:util :: utilì€ spring ìœ í‹¸ë¦¬í‹° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì»¬ë ‰ì…˜ì´ë‚˜ ìƒìˆ˜ì™€ ê°™ì€ ìœ í‹¸ë¦¬í‹° ë¹ˆì„ ì •ì˜
xmlns:jee  :: java ee í†µí•©ì„ ìœ„í•œ spring ë„¤ì„ìŠ¤í˜ì´ìŠ¤ 
xsi:schemaLocation :: xmlíŒŒì¼ì´ ì—¬ëŸ¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ, í•´ë‹¹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ìŠ¤í‚¤ë§ˆ íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì •ì˜ ã…‹+


pre main post íƒ€ëŠ”ì§€ 

ê°•ì œë¡œ exception 

chunkserviceimpl ê°’ ë°˜í™˜ ë°›ëŠ”ì§€ 

chunkserviceimpl
 
 buildStatus

centercutagentimpl

threadpoolexecutor




select * fROM AFCC_JOB_INSTANCE WHERE JOB_ID IN ('sample1') and exec_date = 20240919;
select *   fROM AFCC_CHUNK WHERE JOB_ID IN ('sample1') and exec_date = 20240919;

ìˆ˜ì„ë‹˜ ìš”ì²­í•˜ì‹  ê°•ì œ exception ë°œìƒê²½ìš° ê³µìœ ë“œë¦½ë‹ˆë‹¤ 
1. chunkserviceimpl.java preProcessHandler.handle ì—ì„œ ê°•ì œ exception ì²˜ë¦¬ ì „ [ chunkStatus=ASSIGN ]
Chunk [jobId=sample5, execDate=20240919, execSeq=1, chunkSeq=1, startIndex=1, endIndex=3, threadGroup=null, agentId=agent, chunkStatus=ASSIGN, jobConfig=JobConfiguration [jobId=sample5, jobName=null, description=null, groupId=null, jobDefinition=JobDefinition [domainId=domain, headServiceId=null, bodyServiceId=movieSvc_getList, tailServiceId=null, targetInputTable=sample_input_table, itemReader=centercutItemReader, jobPreProcessor=null, jobPostProcessor=null, chunkPreProcessor=null, chunkPostProcessor=null, headServiceInterceptor=null, bodyServiceInterceptor=null, tailServiceInterceptor=null], jobDistributionPolicy=JobDistributionPolicy [executionPolicy=PARALLEL, chunkPartitionPolicy=UNIT_COUNT, chunkSize=99], jobExecutionPolicy=JobExecutionPolicy [maxThreadCount=1, maxErrorRate=100, maxErrorRepeatCount=-1, autoRetryCount=1, processingInterval=0, timeout=-1, logging=true, logLevel=ERROR, simulation=false, systemErrorRetry=false]], chunkStats=ChunkStats [inputCount=3, inputTotal=0, successCount=0, successTotal=0, failCount=0, failTotal=0, bizFailCount=0, bizFailTotal=0], reprocessCount=0, exitMessage=, chunkHistory=ChunkHistory [preProcessStartTime=0, preProcessEndTime=0, mainProcessStartTime=0, mainProcessEndTime=0, postProcessStartTime=0, postProcessEndTime=0], parameters={}, startTime=1726723255097]

2.chunkserviceimpl.java preProcessHandler.handle ì—ì„œ ê°•ì œ exception ì²˜ë¦¬ í›„ [chunkStatus=PRE_PROCESS_FAIL]
Chunk [jobId=sample5, execDate=20240919, execSeq=1, chunkSeq=1, startIndex=1, endIndex=3, threadGroup=null, agentId=agent, chunkStatus=PRE_PROCESS_FAIL, jobConfig=JobConfiguration [jobId=sample5, jobName=null, description=null, groupId=null, jobDefinition=JobDefinition [domainId=domain, headServiceId=null, bodyServiceId=movieSvc_getList, tailServiceId=null, targetInputTable=sample_input_table, itemReader=centercutItemReader, jobPreProcessor=null, jobPostProcessor=null, chunkPreProcessor=null, chunkPostProcessor=null, headServiceInterceptor=null, bodyServiceInterceptor=null, tailServiceInterceptor=null], jobDistributionPolicy=JobDistributionPolicy [executionPolicy=PARALLEL, chunkPartitionPolicy=UNIT_COUNT, chunkSize=99], jobExecutionPolicy=JobExecutionPolicy [maxThreadCount=1, maxErrorRate=100, maxErrorRepeatCount=-1, autoRetryCount=1, processingInterval=0, timeout=-1, logging=true, logLevel=ERROR, simulation=false, systemErrorRetry=false]], chunkStats=ChunkStats [inputCount=3, inputTotal=0, successCount=0, successTotal=0, failCount=0, failTotal=0, bizFailCount=0, bizFailTotal=0], reprocessCount=0, exitMessage=, chunkHistory=ChunkHistory [preProcessStartTime=0, preProcessEndTime=0, mainProcessStartTime=0, mainProcessEndTime=0, postProcessStartTime=0, postProcessEndTime=0], parameters={}, startTime=1726723255097]

3. AFCC_CHUNK í…Œì´ë¸”ì˜ PRE_PROCESS_FAIL ìƒíƒœê°’ ë³€ê²½ë©ë‹ˆë‹¤.
select * From AFCC_JOB_INSTANCE
 WHERE JOB_ID IN ('sample5')
 ;
 


ìˆ˜ì„ë‹˜ ìš”ì²­í•˜ì‹  ê°•ì œ exception ë°œìƒê²½ìš° ê³µìœ ë“œë¦½ë‹ˆë‹¤ 
1. chunkserviceimpl.java preProcessHandler.handle ì—ì„œ ê°•ì œ exception ì²˜ë¦¬ ì „ [ chunkStatus=ASSIGN ]

2. chunkserviceimpl.java preProcessHandler.handle ì—ì„œ ê°•ì œ exception ì²˜ë¦¬ í›„ [chunkStatus=PRE_PROCESS_FAIL]

3. AFCC_CHUNK í…Œì´ë¸”ì˜ PRE_PROCESS_FAIL ìƒíƒœê°’ ë³€ê²½ë©ë‹ˆë‹¤

4. ìˆ˜ì„ë‹˜ì´ ë§ì”€í•˜ì‹ ê²ƒ ì²˜ëŸ¼ chunk ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒë˜ë©´ 
   ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ ì•ˆíƒ€ê³  ë°”ë¡œ failë¡œ ë–¨ì–´ì§„ í›„ 
   centercutagentimpl.java ì˜ executeë©”ì†ŒìŠ¤ì—ì„œ catch ë¬¸ íƒ€ë©´ì„œ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ë©ë‹ˆë‹¤.
   
select * From AFCC_JOB_INSTANCE
 WHERE JOB_ID IN ('sample5')
 ;
 
 select * fROM AFCC_CHUNK WHERE JOB_ID IN ('sample5');
 
delete fROM AFCC_JOB_INSTANCE WHERE JOB_ID IN ('sample4');
++++++++++++++++++++++++++++++++++++++++
delete  fROM AFCC_CHUNK WHERE JOB_ID IN ('sample4');
commit;

===============================================0923
ìˆ˜ì„ë‹˜ decompilerì—ì„œ ì¶”ê°€í•˜ì‹  logger ë¶€ë¶„ ì†ŒìŠ¤ê°€ ì•ˆì°íˆëŠ” ì´ìœ ëŠ” 

ìˆ˜ì„ë‹˜ì´ ì¶”ê°€í•˜ì‹  catch ë¬¸ íƒ€ê¸° ì „ì— throw ì²˜ë¦¬ê°€ ë˜ì„œ 
ì†ŒìŠ¤ ë¡œì§ì´ ëë‚œê±¸ë¡œ ë³´ì…ë‹ˆë‹¤ 
ì¶”ê°€í•˜ì‹  catch ë¬¸ íƒ€ê¸° ì „ì— ìœ„ì— ìˆëŠ” ì†ŒìŠ¤ ë¡œì§ì—ì„œ 
í”„ë¡œì„¸ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì–´ decompiler íˆ´ì—ì„œë„ ì¶œë ¥ì´ ì•ˆëœê±¸ë¡œ ë³´ì…ë‹ˆë‹¤.

âœ…ë¬¸ì˜ : compile ì‹œ java ì†ŒìŠ¤ ì „ë¶€ê°€ ì•„ë‹Œ ì¼ë¶€ë§Œ compiler ë¡œ ì¶œë ¥ë˜ëŠ”ì§€ ê¶ê¸ˆ 

ì¡°ì¹˜ : ì´ì¤‘ forë¬¸ì—ì„œ TransactionSynchronizationManager.registerSynchronization(synchronization) ìœ„ì—ìˆëŠ” try catch ë¬¸ ì œê±° í›„ compiler í•´ë³´ë‹ˆ handler ë©”ì†Œë“œì˜ ì†ŒìŠ¤ì½”ë“œ ì „ë¶€ê°€ ì¶œë ¥ë¨ ! 

ì„¤ëª… : compiler ëŠ” java ì˜ ì†ŒìŠ¤ì „ë¶€ë¥¼ compile í•˜ì§€ ì•ŠìŒ ! 
compiler ê°€ ì‹œìŠ¤í…œë¡œì§ìœ¼ë¡œ ë´¤ì„ ë•Œ ì˜ë¯¸ì—†ëŠ” ì†ŒìŠ¤ ( try catch ë¥¼ í•  í•„ìš”ë¡œ ì—†ëŠ”ë° í•˜ëŠ” ê²½ìš° ë“±)
ëŠ” ì¶œë ¥í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— compiler ì—ì„œ ìœ íš¨í•œ ì†ŒìŠ¤ë§Œ ì¶œë ¥ëœê±°ì„ ! 


===============================================0924

âœ…ë¬¸ì˜: hcm anyframe-online-runtime-ext-6.1.0  ì·¨ì•½ì  ì¡°ì¹˜ 

ë‹µë³€: hcm ì†ŒìŠ¤ë°›ì€ í›„ pom.xml ìˆ˜ì •í•¨ 
 <dependency>
			<groupId>xerces</groupId>
			<artifactId>xercesImpl</artifactId>
			<version>2.12.2</version>
		</dependency>

ì„¤ëª… : hcm ì´ë‘ ê¸°ìˆ ì§€ì› ì†ŒìŠ¤ì°¨ì´ëŠ” ServiceIdMappingAnnotationServiceMappingAsmExtíŒŒì¼ í•˜ë‚˜ë§Œ ë‹¤ë¥´ê³  
xercesImplì˜ ì˜í–¥ë„ëŠ” ì—†ì–´ì„œ  pom.xml ì—ì„œ ìˆ˜ì • í›„ ì „ë‹¬í•¨ ! 

=============ë¡œì»¬ì—ë§ŒìˆëŠ”ì†ŒìŠ¤

=============ìš´ì˜ì—ë§Œ ìˆëŠ” ì†ŒìŠ¤
/home/kpcnc/output/sample/real/com/anyframe/online/runtime/ext/service/mapping/ServiceIdMappingAnnotationServiceMappingAsmExt.class
[kpcnc@centos7][/home/kpcnc/output/sample/log]$


===============================================0925
ë¬¸ì˜ : 
    ì„œë¹„ìŠ¤ì„ í›„ì²˜ë¦¬ chunkService ë¡œ ì‹¤í–‰í•˜ë©´ ì˜¤ë¥˜ë‚˜ëŠ” ë¶€ë¶„ 
ë‹µë³€ : 
    MainProcessHandler ì—ì„œ ì˜¤ë¥˜ ë‚¨ 
    java.lang.ClassCastException: com.anyframe.centercut.runtime.service.ChunkServiceImpl cannot be cast to com.anyframe.centercut.runtime.service.interceptor.OnlineServiceInterceptor
    at com.anyframe.centercut.runtime.service.handler.ItemProcessHandler.handle(ItemProcessHandler.java:147) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
    at com.anyframe.centercut.runtime.service.handler.MainProcessHandler.handle(MainProcessHandler.java:106) ~[anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
    at com.anyframe.centercut.runtime.service.ChunkServiceImpl.execute(ChunkServiceImpl.java:94) [anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
    at com.anyframe.centercut.runtime.agent.CenterCutAgentImpl$1.run(CenterCutAgentImpl.java:112) [anyframe-centercut-runtime-6.5.0-SNAPSHOT.jar:na]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_202]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_202]
    at java.lang.Thread.run(Thread.java:748) [na:1.8.0_202]

    ItemProcessHandler.java
    final OnlineServiceInterceptor onlineServiceInterceptor = (OnlineServiceInterceptor) processorFactory
					.createInstance(onlineServiceInterceptorId);

ë¬¸ì˜ : 
    [ì´ê¸°ì£¼] 09-24 13:42
    ì›ì¸ : ì²˜ë¦¬ ìƒíƒœê°’ ë³€ê²½ ì¤‘ Lock ë°œìƒ
    Caused by: org.springframework.dao.DeadlockLoserDataAccessException: PreparedStatementCallback; 
    SQL [UPDATE BATCH_RESOURCE_EXECUTION SET URL=?, STATUS = ?, UPDATE_TIME=? WHERE JOB_ID = ? 
    AND STEP_ID = ? AND RESOURCE_NAME = ?]; 
    (conn=4866290) Deadlock found when trying to get lock; try restarting transaction; 
    nested exception is java.sql.BatchUpdateException: (conn=4866290) Deadlock found when trying to get lock; try restarting transaction

ì¡°ì¹˜ : 
    íŠ¹ì • job ìˆ˜í–‰ì´ 700000ms ì´ìƒ 13ë¶„ ì´ìƒ ìˆ˜í–‰ë˜ì„œ lock ê±¸ë¦¼ 

    mariadb ëŠ” in memory êµ¬ì¡°ë¡œ ë°ì´í„°ì™€ ì¸ë°ìŠ¤ë¥¼ ë©”ëª¨ë¦¬ì— ìºì‹±í•˜ê¸° ìœ„í•œ ë²„í¼í’€ 
    oracle - mvcc 

    -íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€
    SERIALIZABLE    : íŠ¸ëœì­ì…˜ì´ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ë™ì‹œ ì²˜ë¦¬ ì„±ëŠ¥ì´ ë–¨ì–´ì§ 
    REPEATABLE READ : mvccë¥¼ ì´ìš©í•´ í•œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë™ì¼í•œ ê²°ê³¼ë¥¼ ë³´ì¥í•˜ì§€ë§Œ, ìƒˆë¡œìš´ ë ˆì½”ë“œê°€ ì¶”ê°€ë˜ëŠ” ê²½ìš°ì— ë¶€ì •í•© ìƒê¸¸ ìˆ˜ ìˆìŒ 
    READ COMMITTED  : ì»¤ë°‹ëœ ë°ì´í„°ë§Œ ì¡°íšŒ, ë°˜ë³µ ì½ê¸° ë¶ˆê°€ëŠ¥,,
    READ UNCOMMITED : ì»¤ë°‹í•˜ì§€ ì•ŠëŠ” ë°ì´í„° ì¡°ì°¨ë„ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²©ë¦¬ ìˆ˜ì¤€
    https://mangkyu.tistory.com/299 

    íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ í™•ì¸ ë°©ë²•
    show variables like '%isolation%';

    autocommit ì—¬ë¶€ í™•ì¸ ë°©ë²• 
    show variables like 'autocommit%';
    *ë§¤ ë¬¸ì¥ë§ˆë‹¤ commit ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¶€í•˜ê°€ ê³¼ë‹¤í•´ì ¸ì„œ dbì „ì²´ ì„±ëŠ¥ì— ì•…ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŒ => off ê¶Œì¥ 

===============================================0927
engine
JobExecutionServiceImpl
JobInstanceRepositoryImpl

runtime
CenterCutAgentImpl.java
ChunkServiceImpl.java
ItemProcessHandler.java
MainProcessHandler.java
PostProcessHandler.java


ChunkServiceImpl.java () 110


class OnlineResultHolder {
	private Object result;

	public Object getResult() {
		return result;
	}

	public void setResult(Object result) {
		this.result = result;
	}
}

------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.720 s
[INFO] Finished at: 2024-09-27T10:28:03+09:00
[INFO] Final Memory: 31M/414M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project anyframe-centercut-runtime: Compilation failure: Compilation failure:
[ERROR] \Users\kpcnc\git\anyframe-centercut-samfire-agent.5.0.2\anyframe-centercut-runtime\src\main\java\com\anyframe\centercut\runtime\service\handler\ItemProcessHandler.java:[126,9] error: cannot find symbol
[ERROR] \Users\kpcnc\git\anyframe-centercut-samfire-agent.5.0.2\anyframe-centercut-runtime\src\main\java\com\anyframe\centercut\runtime\service\handler\ItemProcessHandler.java:[126,41] error: cannot find symbol
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException











------------------------------------------------------------------------241004 
ë¬¸ì˜ : ext ì†ŒìŠ¤ë¹„êµ


----------:: ë¡œì»¬ìƒ˜í”Œ
++++++++++:: ìš´ì˜ìƒ˜í”Œ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/CBOMessageBuilder.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/CBOMessageBuilder.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/CentercutMessageBuilder.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/CentercutMessageBuilder.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/CommonConstants.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/CommonConstants.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/CentercutInputTableDao.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/CentercutInputTableDao.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/InputTableParameterSource.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/InputTableParameterSource.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/InputTableRowMapper.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/InputTableRowMapper.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/ItemRepositoryImpl.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/ItemRepositoryImpl.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/JobInstanceDao.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/JobInstanceDao.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/JobInstanceRowMapper.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/JobInstanceRowMapper.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/JobInstanceStatsRowMapper.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/JobInstanceStatsRowMapper.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/dao/vo/InputTableVo.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/dao/vo/InputTableVo.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/executor/CBOOnlineServiceExecutor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/executor/CBOOnlineServiceExecutor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CBOBeanProcessorFactory.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CBOBeanProcessorFactory.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CommonChunkPostProcessor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CommonChunkPostProcessor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CommonChunkPreProcessor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CommonChunkPreProcessor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CommonJobPostProcessor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CommonJobPostProcessor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CommonJobPreProcessor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CommonJobPreProcessor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/factory/CommonOnlineServiceInterceptor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/factory/CommonOnlineServiceInterceptor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/service/DummyDataSource.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/DummyDataSource.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/service/handler/ChunkStatusCheckerImpl.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/handler/ChunkStatusCheckerImpl.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/service/interceptor/ItemExecutionInterceptor.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/interceptor/ItemExecutionInterceptor.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/service/reader/CentercutItemReader.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/reader/CentercutItemReader.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/service/SampleDummyService.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/SampleDummyService.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/stats/CentercutChunkStatsBuilder.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/stats/CentercutChunkStatsBuilder.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/stats/ChunkStatsInfo.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/stats/ChunkStatsInfo.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/stats/JobInstanceStatsInfo.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/stats/JobInstanceStatsInfo.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/status/CentercutItemStatus.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/status/CentercutItemStatus.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/util/CentercutCommonUtil.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/util/CentercutCommonUtil.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/centercut/runtime/ext/util/JobStatusUtil.class and /home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/util/JobStatusUtil.class differ
Binary files /home/kpcnc/output/sample/local/com/anyframe/plugin/processor/SampleJobPreProcessor.class and /home/kpcnc/output/sample/real/com/anyframe/plugin/processor/SampleJobPreProcessor.class differ
=============ë¡œì»¬ì—ë§ŒìˆëŠ”ì†ŒìŠ¤

=============ìš´ì˜ì—ë§Œ ìˆëŠ” ì†ŒìŠ¤
/home/kpcnc/output/sample/real/com/anyframe/centercut/runtime/ext/service/interceptor/CBOOnlineExecutionInterceptor.class
[kpcnc@centos7][/home/kpcnc/output/sample/log]$







------------------------------------------------------------------------241004 
ë¬¸ì˜ : ibk controller ì •ë¦¬

ë°©ë²• : 
K:\Shared files\Anyframe Study\ê¹€ì˜ˆì€\ì—…ë¬´\241004 ibk controller

1.svn check out 

    ì˜¨ë¼ì¸
    http://182.195.89.102/subv/anyframe-enterprise/anyframe-enterprise-online-site/ibk/release/anyframe-online-admin


    ê³µí†µ
    http://182.195.89.102/subv/anyframe-enterprise/anyframe-enterprise-admin-site/ibk/release


    ë°°ì¹˜ 
    http://182.195.89.102/subv/anyframe-enterprise/anyframe-enterprise-batch-5.0/trunk/anyframe-batch-admin
    --http://182.195.89.102/subv/anyframe-enterprise/anyframe-enterprise-batch-5.0/tags/5.1.0/anyframe-batch-admin-5.1.0


    ì„¼í„°ì»·
    http://182.195.89.102/subv/anyframe-enterprise/anyframe-enterprise-bto/trunk/anyframe-centercut-admin

2. ì–‘ì‹ì— ë§ê²Œ ì‘ì„±


agent
centercut

==================
INSERT INTO AFT_APPLICATION (APPL_ID,APPL_NAME,APPL_URL,CREATE_ID) VALUES ('6000','Anyframe Java Admin','/anyframe-online-admin/index.html','system');

Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6000',null,'ì˜¨ë¼ì¸','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6100','6000','Server Execution','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6200','6000','Domain Management','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6300','6000','Service Meta','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6400','6000','Service Control','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6500','6000','Error Trace','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6610','6000','ì†¡ìˆ˜ì‹ ë¡œê·¸ ì¡°íšŒ','MENU',null,null,null,null,'Y','Y','system',null,'admin',null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6620','6000','ê±°ë˜ì „ë¬¸ ë¡œê·¸','MENU',null,null,null,null,'Y','Y','system',null,'admin',null,'6000');
Insert into AFT_MENU (MENU_ID,PARENT_MENU_ID,MENU_NAME,MENU_TYPE,MENU_LOAD_TYPE,MENU_LEVEL,MENU_SEQ,MENU_URL,LEAF_YN,USE_YN,CREATE_ID,CREATE_DATE,UPDATE_ID,UPDATE_DATE,APPL_ID) values ('6700','6000','DWIO ê´€ë¦¬','MENU',null,null,null,null,'Y','Y','system',null,null,null,'6000');

INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6000');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6100');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6200');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6300');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6400');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6500');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6610');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6620');
INSERT INTO AFT_ROLE_MENU(ROLE_ID,MENU_ID) VALUES ('9000','6700'); 
ê´€ë ¨ í…Œì´ë¸” ì‚­ì œí•˜ê¸° 



<spring.version>4.3.6.RELEASE</spring.version> ë‹¤ì‹œí•´ë³´ê¸° ~


https://devops.sdsdev.co.kr/confluence/pages/viewpage.action?pageId=1218802352

1. agent ì„¸íŒ…
2. centercut í”„ë¡œì„¸ìŠ¤ í™•ì¸
3. centercut admin git pull ë°›ê¸°




===============================1018
sghkkk5777@hanmail.net : api ë‹´ë‹¹ì
qjawns0618@naver.com : ë²”ì¤€ì±…ì„ë‹˜


SELECT * FROM INSTANCE_CONFIGURATION A LEFT OUTER JOIN SERVER_CONFIGURATION B ON A.SERVER_CONFIG_ID = B.ID
;
Insert into INSTANCE_CONFIGURATION (ID,DOMAIN_ID,INSTANCE_ID,IP,PORT,START_TIME,JMX_URL,SERVER_CONFIG_ID,SERVICE_CONFIG_ID,INVOKE_URL) values ('tenantIdA_domain_instance1','domain1','instance1','localhost','8081','20240911172115','service:jmx:rmi://localhost:8081/jndi/rmi://localhost:8081/jmxrmi',null,null,'http://localhost:8081/anyframe-online-aui-mybatis-pi/management');
select * From domain_configuration;
select * From INSTANCE_CONFIGURATION;

select * from domain_configuration ;
select * from SERVER_CONFIGURATION;

SELECT * FROM INSTANCE_CONFIGURATION A LEFT OUTER JOIN SERVER_CONFIGURATION B ON A.SERVER_CONFIG_ID = B.ID
;
invoke_url : online í˜¸ì¶œ ì‹œ 
SELECT * FROM DOMAIN_CONFIGURATION A LEFT OUTER JOIN SERVER_CONFIGURATION B ON A.SERVER_CONFIG_ID = B.ID 
;

SELECT * FROM SERVER_CONFIGURATION_PATTERN
;

--CREATE TABLE SERVER_CONFIGURATION_PATTERN (
--  ID VARCHAR(200),
--  SERVER_CONFIGURATION_ID VARCHAR(200),
--  DATE_UNIT VARCHAR(10),
--  DAY CHAR(2),
--  START_TIME CHAR(5),
--  END_TIME CHAR(5),
--  CONSTRAINT SERVER_CONFIG_PATTERN_PK PRIMARY KEY ( ID,SERVER_CONFIGURATION_ID )
--);
select * From BATCH_SERVER;

select * from BATCH_JOB_EXECUTION;

select * from AFT_CODE_GROUP;

===============================1101
batch manager jobmonitor ì¿¼ë¦¬ í™•ì¸


ê´€ë¦¬ ë ˆë²¨ë¡œ ì˜¬ë¼ê°€ê¸° ì „ê¹Œì§€ ê¸°ìˆ ì¸ë ¥ìœ¼ë¡œì„œ ê°€ì¥ ë†’ì´ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆëŠ” ì—­í• ì´ AA
ë¹„ìš©ê´€ë¦¬
ì¼ì • ê´€ë¦¬
ìš”êµ¬ ì‚¬í•­ì •ì˜
ëª…ì„¸ ìˆ˜ë¦½
ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„
í”„ë¡œê·¸ë˜ë°
ê°œë°œ ë°©ë²•ë¡ 
ì¸í”„ë¼ êµ¬ì¶•
í…ŒìŠ¤íŠ¸ ë°©ë²•
í’ˆì§ˆ ê´€ë¦¬

1. shell í™œìš©í•œ batch í”„ë¡œê·¸ë ˜ ë‚´ë¶€ê°œë°œ
- ê¸ˆìœµì‚¬ ì¹´ë“œì •ë³´ë¥¼ DBTOFILE í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ë  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ 

2. api í†µì‹  
REST API í†µì‹  ëª…ì„¸í™”

3. gwt í†µì‹ ìœ¼ë¡œëœ anyframe 5ë²„ì „ êµ¬ì„±ì„ ìœ„í•œ ê³µí†µ ì„¤ì •
online, batch, common, manager ì„¤ì • 
spring version, gwt 2.4, maven pmd ìƒëµ ë“±..

4.ê³„ì •ê³„, ìš´ì˜ê³„, ì •ë³´ê³„ ë¯¸ë“¤ì›¨ì–´ êµ¬ì¶•/ìš´ì˜
-ì •ê¸°ì ê²€
ì·¨ì•½ì  ê²€ì¶œ ë„ëª¨ & ê°œì„  

https://iseop.tistory.com/63

SELECT * FROM ( SELECT INNER_TABLE.* , ROWNUM AS ROW_SEQ FROM ( 
SELECT * FROM ( 
	SELECT  
	INSTANCE.JOB_ID, INSTANCE.EXEC_DATE, INSTANCE.EXEC_SEQ, INSTANCE.INSTANCE_STATUS, INSTANCE.APP_ID, INSTANCE.APP_SEQ, 
	INSTANCE.DOMAIN_ID, INSTANCE.HEAD_SERVICE_ID, INSTANCE.BODY_SERVICE_ID, INSTANCE.TAIL_SERVICE_ID, INSTANCE.TARGET_INPUT_TABLE, 
	INSTANCE.JOB_PRE_PROCESSOR, INSTANCE.JOB_POST_PROCESSOR,  
	INSTANCE.CHUNK_PRE_PROCESSOR, INSTANCE.CHUNK_POST_PROCESSOR, 	
	INSTANCE.HEAD_INTERCEPTOR, INSTANCE.BODY_INTERCEPTOR, INSTANCE.TAIL_INTERCEPTOR, INSTANCE.ITEM_READER, 
	INSTANCE.EXECUTION_POLICY, INSTANCE.PARTITION_POLICY, INSTANCE.CHUNK_SIZE, 
	INSTANCE.MAX_THREAD_COUNT, INSTANCE.MAX_ERROR_RATE, INSTANCE.MAX_ERROR_REPEAT_COUNT, INSTANCE.AUTO_RETRY_COUNT, INSTANCE.PROCESSING_INTERVAL, INSTANCE.TIMEOUT, INSTANCE.LOGGING, INSTANCE.LOG_LEVEL, 
	INSTANCE.INPUT_COUNT, INSTANCE.INPUT_TOTAL, INSTANCE.SUCCESS_COUNT, INSTANCE.SUCCESS_TOTAL, INSTANCE.FAIL_COUNT, INSTANCE.FAIL_TOTAL, INSTANCE.BIZ_FAIL_COUNT, INSTANCE.BIZ_FAIL_TOTAL, INSTANCE.REPROCESS_COUNT, 
	INSTANCE.PRE_START_TIME, INSTANCE.PRE_END_TIME, INSTANCE.MAIN_START_TIME, INSTANCE.MAIN_END_TIME, INSTANCE.POST_START_TIME, INSTANCE.POST_END_TIME, INSTANCE.SIMULATION, INSTANCE.SYSTEM_ERROR_RETRY, 
	CONFIG.JOB_NAME, CONFIG.GROUP_ID 
	FROM   
	AFCC_JOB_INSTANCE INSTANCE LEFT OUTER JOIN AFCC_JOB_CONFIG CONFIG ON INSTANCE.JOB_ID = CONFIG.JOB_ID 
)  
 WHERE 
 (PRE_START_TIME BETWEEN :fromTime AND :toTime ) and PRE_START_TIME is not null
 ORDER BY PRE_START_TIME DESC, JOB_ID ASC ;
 
  select * from AFCC_JOB_INSTANCE
 where exec_date = 20241029
 and PRE_START_TIME is null;
 24/10/29 10:44:08.567000000
24/10/29 10:15:54.510000000
24/10/29 10:20:48.416000000
24/10/29 10:30:11.027000000
24/10/29 11:07:12.360000000

jsíŒŒì¼
--------------------------241111
ë¬¸ì˜ : [ì‚¼ì„±ì„œìš¸ë³‘ì›] Unexpected error occured in scheduled task ì—ëŸ¬ ê´€ë ¨ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.
ì›ì¸ : 
    22, 27ëª¨ë“ˆì—ì„œ 7:40 nullponintexception 
    
    ë°›ì€ ë¡œê·¸ì—ì„œëŠ” 7ì‹œ 10ë¶€í„° timeout, connect ì˜¤ë¥˜ ê³„ì† ë°œìƒ 
    30ë¶„ë™ì•ˆ 7:40ê¹Œì§€ ì„¸ì…˜ì´ ì•„ì˜ˆ ëŠì–´ì ¸ì„œ ë°œìƒí•œ ì˜¤ë¥˜ë¡œ íŒë‹¨ 

    ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê±´ 
    2024-11-09 07:34:23.636 [1 ocessor-46|   MinaRecvIoHandler] [INFO ] Closed.. (0x00000009: nio socket, client, /119.6.6.56:51702 => /119.2.200.110:8000)
    2024-11-09 07:34:29.101 [1 ECV_2210-1|ClientSessionManager] [ERROR] org.apache.mina.core.RuntimeIoException: Failed to get the session. : CHAN000096 : /119.2.200.110:8000


    2024-11-09 07:37:31.092 [1 cessor-147|   MinaRecvIoHandler] [INFO ] Closed.. (0x00000014: nio socket, client, /119.6.6.56:51721 => /203.249.202.89:8000)
    2024-11-09 07:37:59.591 [1 ECV_2289-1|ClientSessionManager] [ERROR] org.apache.mina.core.RuntimeIoException: Failed to get the session. : CHAN000103 : /203.249.202.89:8000 : ì„¸ì…˜ ì—°ê²° ì°¨ë‹¨ëœ ìƒíƒœë¼ì„œ ë°œìƒí•œ ì—ëŸ¬
    Session Closed.. 

    2024-11-09 07:39:13.785 [1 cessor-157|   MinaRecvIoHandler] [INFO ] Closed.. (0x00000015: nio socket, client, /119.6.6.56:51726 => /203.249.202.90:8000)
    2024-11-09 07:39:29.638 [1 ECV_2290-1|ClientSessionManager] [ERROR] org.apache.mina.core.RuntimeIoException: Failed to get the session. : CHAN000104 : /203.249.202.90:8000
    
    2024-11-09 07:40:07.219 [1 cessor-171|   MinaRecvIoHandler] [INFO ] Closed.. (0x00000194: nio socket, client, /119.6.6.56:52941 => /119.2.202.71:8000)
    2024-11-09 07:40:35.749 [1 ECV_2291-1|ClientSessionManager] [ERROR] org.apache.mina.core.RuntimeIoException: Failed to get the session. : CHAN000203 : /119.2.202.71:8000

    ? Session Closed..  vs Closed ì°¨ì´ê°€ ë­”ì§€..
    ? Unexpected error occurred in scheduled task.java.lang.NullPointerException ì—ì„œ null ì°¸ì¡°ê°€ ë˜ì„œ ë°œìƒëœê±´ë°,, ì–´ë””ì„œ.. ??

ì¡°ì¹˜ : afi ëŠ” ì•ìœ¼ë¡œ ìƒìš©í™”?ê°€ ì•ˆë  ì˜ˆì •ì´ë¼ì„œ íŒ€ì¥ë‹˜ì´ í™•ì¸í•˜ì‹ ë‹¤ê³  í•¨! 

============================================1114 
ë¬¸ì˜ : ìµœìˆ˜ì„ë‹˜ ì˜¤ë¥˜ ë¬¸ì˜ 
ERROR TaskUtils$LoggingErrorHandler : Unexpected error occurred in scheduled task 
java.lang.NullPointerException: null
at com.anyframe.centercut.engine.execution.monitor.JobExecutionMonitorImpl.checkFinishChunks(JobExecutionMonitorImpl.java:61)

ì›ì¸ : ëª¨ë‹ˆí„°ë§ì—ì„œ ê±¸ë¦¼ 

ì¡°ì¹˜ : selectFinishedChunks ì¿¼ë¦¬ db ì¡°íšŒ 
 SELECT /*+ LEADING(CHUNK, INSTANCE) USE_NL(CHUNK INSTANCE)  */ 
    CHUNK.JOB_ID, CHUNK.EXEC_DATE, CHUNK.EXEC_SEQ, CHUNK_SEQ, START_INDEX, 
    END_INDEX, THREAD_GROUP, CHUNK_STATUS, AGENT.AGENT_ID, MONITOR_CHECK, 
    CHUNK.PRE_START_TIME, CHUNK.PRE_END_TIME, CHUNK.MAIN_START_TIME, CHUNK.MAIN_END_TIME, 
    CHUNK.POST_START_TIME, CHUNK.POST_END_TIME, CHUNK.INPUT_COUNT, CHUNK.INPUT_TOTAL, 
    CHUNK.SUCCESS_COUNT, CHUNK.SUCCESS_TOTAL, CHUNK.FAIL_COUNT, CHUNK.FAIL_TOTAL, 
    CHUNK.BIZ_FAIL_COUNT, CHUNK.BIZ_FAIL_TOTAL, INSTANCE.DOMAIN_ID, HEAD_SERVICE_ID, 
    BODY_SERVICE_ID, TAIL_SERVICE_ID, TARGET_INPUT_TABLE, JOB_PRE_PROCESSOR, 
    JOB_POST_PROCESSOR, CHUNK_PRE_PROCESSOR, CHUNK_POST_PROCESSOR, HEAD_INTERCEPTOR, 
    BODY_INTERCEPTOR, TAIL_INTERCEPTOR, ITEM_READER, EXECUTION_POLICY, PARTITION_POLICY, 
    CHUNK_SIZE, INSTANCE.MAX_THREAD_COUNT, MAX_ERROR_RATE, MAX_ERROR_REPEAT_COUNT, AUTO_RETRY_COUNT, 
    PROCESSING_INTERVAL, TIMEOUT, LOGGING, SIMULATION, LOG_LEVEL, SYSTEM_ERROR_RETRY 
    FROM AFCC_AGENT_CONFIG AGENT, 
    AFCC_CHUNK CHUNK, 
    AFCC_JOB_INSTANCE INSTANCE 
 WHERE RTRIM(CHUNK.JOB_ID) = INSTANCE.JOB_ID 
 AND RTRIM(CHUNK.EXEC_DATE) = INSTANCE.EXEC_DATE 
 AND CHUNK.EXEC_SEQ = INSTANCE.EXEC_SEQ 
 AND CHUNK_STATUS IN (:chunkStatus) 
 AND AGENT.AGENT_ID = CHUNK.AGENT_ID AND MONITOR_CHECK = :monitorCheck 


SELECT /*+ LEADING(CHUNK, INSTANCE) USE_NL(CHUNK INSTANCE)  */ 
    CHUNK.JOB_ID, CHUNK.EXEC_DATE, CHUNK.EXEC_SEQ, CHUNK_SEQ, START_INDEX, 
    END_INDEX, THREAD_GROUP, CHUNK_STATUS, AGENT.AGENT_ID, MONITOR_CHECK, 
    CHUNK.PRE_START_TIME, CHUNK.PRE_END_TIME, CHUNK.MAIN_START_TIME, CHUNK.MAIN_END_TIME, 
    CHUNK.POST_START_TIME, CHUNK.POST_END_TIME, CHUNK.INPUT_COUNT, CHUNK.INPUT_TOTAL, 
    CHUNK.SUCCESS_COUNT, CHUNK.SUCCESS_TOTAL, CHUNK.FAIL_COUNT, CHUNK.FAIL_TOTAL, 
    CHUNK.BIZ_FAIL_COUNT, CHUNK.BIZ_FAIL_TOTAL, INSTANCE.DOMAIN_ID, HEAD_SERVICE_ID, 
    BODY_SERVICE_ID, TAIL_SERVICE_ID, TARGET_INPUT_TABLE, JOB_PRE_PROCESSOR, 
    JOB_POST_PROCESSOR, CHUNK_PRE_PROCESSOR, CHUNK_POST_PROCESSOR, HEAD_INTERCEPTOR, 
    BODY_INTERCEPTOR, TAIL_INTERCEPTOR, ITEM_READER, EXECUTION_POLICY, PARTITION_POLICY, 
    CHUNK_SIZE, INSTANCE.MAX_THREAD_COUNT, MAX_ERROR_RATE, MAX_ERROR_REPEAT_COUNT, AUTO_RETRY_COUNT, 
    PROCESSING_INTERVAL, TIMEOUT, LOGGING, SIMULATION, LOG_LEVEL, SYSTEM_ERROR_RETRY 
    FROM AFCC_AGENT_CONFIG AGENT, 
    AFCC_CHUNK CHUNK, 
    AFCC_JOB_INSTANCE INSTANCE 
 WHERE RTRIM(CHUNK.JOB_ID) = INSTANCE.JOB_ID 
 AND RTRIM(CHUNK.EXEC_DATE) = INSTANCE.EXEC_DATE 
 AND CHUNK.EXEC_SEQ = INSTANCE.EXEC_SEQ 
 AND CHUNK_STATUS IN (?, ?, ?, ?, ?, ?, ?, ?) 
 AND AGENT.AGENT_ID = CHUNK.AGENT_ID AND MONITOR_CHECK = ? 

 jobmonitorexception 

 ORA-28002: 4 ì¼ì•ˆì— ë¹„ë°€ë²ˆí˜¸ê°€ ë§Œê¸°ë  ê²ƒì…ë‹ˆë‹¤
 -> https://heannim-world.tistory.com/93

================================================1115
 - anyframe-xplatform-1.5.1.jar

 - anyframe-tiles-1.0.4.jar
http://182.195.89.102/subv/anyframe-opensource/anyframe/tags/plugin/optional/tiles
https://repository.jboss.org/nexus/content/repositories/releases/org/jboss/el/jboss-el/2.0.1.GA/

 - anyframe-logmanager-1.0.4.jar

 - anyframe-jdbc-support-1.0.4.jar
http://www.java2s.com/Code/Jar/l/Downloadlog4jdbc3121sourcesjar.htm
https://github.com/leopallas/vieo/blob/master/java/ORION%2011J/net/sf/log4jdbc/log4jdbc3/1.2.1/log4jdbc3-1.2.1.pom.lastUpdated


 - anyframe-core-1.5.1.jar
http://182.195.89.102/subv/anyframe-opensource/anyframe/tags/plugin/essential/core/1.5.1/projects
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>jsp-api</artifactId>
    <version>2.0</version> 2.1 -> 2.0
    <scope>provided</scope>
</dependency>

 - spring 3.2.2 ë²„ì „
	<properties>
		<spring.version>3.2.18.RELEASE</spring.version>
		<targetJdk>1.8</targetJdk>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
	</properties>


1. ì¶”ê°€
core : jsp-api-2.1.jar -> javax.servlet.jsp-api.jar
support :  log4jdbc3-1.2beta2.jar -> log4jdbc4-1.2.jar
titles : jboss-el-2.0.1.GA.jar  .jar ì¶”ê°€ 



================
ë¬¸ì˜ : ì–´ë“œë¯¼6 ì—ì„œ ì˜¨ë¼ì¸ > ì„œë¹„ìŠ¤ë©”íƒ€ê´€ë¦¬ > ì„œë¹„ìŠ¤ ë©”íƒ€ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° í´ë¦­ì‹œ 
java.lang.NullPointException
at com.anyframe.admin.online.service.impl.DefaultServiceMetaClector.collectServiceAttributes(DefaultServiceMetaCollector.java:190)

ì›ì¸ : 
ì„í”Œ - ì‹¤ì œì½”ë”©í•˜ëŠ” ê³³
ì¸í„°í˜ì´ìŠ¤ - @ServiceIdMapping ì„œë¹„ìŠ¤ ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ ì •ì˜ë˜ëŠ” ê³³ / ë©”ì†Œë“œë§Œ êµ¬í˜„í•˜ëŠ” ê³³
        - svc ë©”ì†Œë“œë§Œ ì •ì˜í•˜ì—¬ ìƒì†ë‹¹í•˜ëŠ” ì—­í• 

ì˜ˆì „ì—ë„ ì¸í„°í˜ì´ìŠ¤ ì–´ë…¸í…Œì´ì…˜ ì•ˆë‹¬ê³  ì„í”Œì—ì„œ ì–´ë…¸í…Œì´ì…˜ ë‹¬ì•„ì„œ ë¬¸ì œëìŒ

í•´ê²° :
ì‹ ê·œì„œë¹„ìŠ¤ ë§Œë“ ê±°ë¼ë©´
ì¸í„°í˜ì´ìŠ¤ ëª¨ë“ ì†ŒìŠ¤ì—  @ServiceMapping ì •ì˜ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•¨

ë©”íƒ€ë¶ˆëŸ¬ì˜¤ê¸°ë¥¼ ëˆ„ë¥´ë©´ ì¶”ê°€ëœ ì„œë¹„ìŠ¤ëŠ” í•´ë‹¹ ì„œë¹„ìŠ¤ì•„ì´ë””ë¡œë¶€í„° ì¶œë°œí•´ 
service_meta í…Œì´ë¸”ì— ìë™ìœ¼ë¡œ ì¶”ê°€ë¨




